# v1.0.2 更新说明

## ✨ 新功能

### 国内镜像设置优化

- **独立的国内镜像设置分类**
  - 将 GitHub 国内镜像从"关于软件"移至独立的"国内镜像"设置项
  - 使用互联网图标（mdi-web）更直观地表示镜像功能
  - 优化了设置页面的分类结构

- **整合的镜像配置界面**
  - 镜像方式和地址整合在同一行显示
  - 左侧下拉框选择镜像方式（前置代理/域名替换）
  - 右侧输入框填写镜像地址
  - 更简洁直观的配置体验

### 更新检查支持全局代理

- **代理支持增强**
  - 检查更新功能现在支持全局代理设置
  - 读取 changelog 时也会使用代理配置
  - 支持 HTTP/HTTPS/SOCKS5 代理协议
  - 支持代理认证
  - 尊重 SSL 证书验证设置

### 更新失败友好提示

- **智能错误提示**
  - 当无法从 GitHub 获取更新内容时，显示友好的 Markdown 格式提示
  - 提供可能的原因分析（网络问题、GitHub 访问受限）
  - 给出详细的解决方案，引导用户启用国内镜像
  - 推荐常用的镜像地址
  - 提供 GitHub Releases 备用链接

## 🐛 Bug 修复

### 修复 SOCKS5 代理配置问题

- **代理配置重构**
  - 修复了 SOCKS5 代理配置不正确的问题
  - 使用动态导入 `socks-proxy-agent` 和 `https-proxy-agent`
  - 添加完整的 TLS 选项配置（servername、checkServerIdentity）
  - 同时设置 httpAgent 和 httpsAgent 确保所有请求都走代理
  - 修复了 DNS 解析相关的问题

### 修复代理 Agent 创建问题

- **Agent 配置优化**
  - 修复了使用环境变量方式设置代理不生效的问题
  - 改用 axios 的 proxy 配置对象
  - 正确配置 httpAgent 和 httpsAgent
  - 根据代理协议类型选择合适的 Agent 类型

### 增强错误日志

- **调试信息完善**
  - 添加详细的代理配置日志
  - 记录 DNS 解析错误详情
  - 显示 TLS 选项配置
  - 便于问题排查和调试

## 🔧 技术改进

- 重构了 `buildAxiosConfig` 函数，改为异步函数
- 使用动态导入代理库，避免静态依赖
- 优化了代理配置的应用逻辑，与 POC 处理方式保持一致
- 改进了错误处理机制，提供更友好的用户提示
- 增强了 DNS 解析错误的检测和提示

## 📦 依赖更新

- 新增 `socks-proxy-agent` 依赖（支持 SOCKS5 代理）
- 新增 `https-proxy-agent` 依赖（支持 HTTP/HTTPS 代理）

## 📝 使用说明

**关于国内镜像：**

- 前往"软件设置 → 国内镜像"启用 GitHub 国内镜像
- 选择合适的镜像方式：
  - **前置代理**：在 URL 前添加镜像地址（如 `https://mirror.ghproxy.com/`）
  - **域名替换**：替换 GitHub 域名（如 `hub.gitmirror.com`）
- 推荐镜像地址：
  - 前置代理：`https://mirror.ghproxy.com/` 或 `https://ghproxy.com/`
  - 域名替换：`hub.gitmirror.com` 或 `gitclone.com`

**关于代理设置：**

- 检查更新功能现在会使用全局代理设置
- 确保代理服务器可以访问 GitHub
- SOCKS5 代理现在可以正常工作
- 如遇到 DNS 解析问题，建议启用国内镜像

**关于更新检查：**

- 如果检查更新失败，会显示友好的错误提示
- 按照提示启用国内镜像可以解决大部分访问问题
- 也可以直接访问 GitHub Releases 页面查看更新
