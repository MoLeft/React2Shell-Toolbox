# v1.0.3 更新说明

## ✨ 新功能

### 批量验证模块（FOFA 集成）

- **FOFA API 集成**
  - 完整的 FOFA API 支持（搜索、统计、用户信息查询）
  - 支持 FOFA 搜索语法，快速定位目标资产
  - 实时显示用户信息（头像、用户名、F币、F点、VIP状态）
  - 连接状态实时监控和刷新

- **智能筛选系统**
  - 支持 7 种维度的统计聚合：协议、域名、端口、HTTP标题、操作系统、HTTP Server、国家/城市
  - 按需加载统计数据，节省 API 配额
  - 支持多条件组合筛选
  - 一键加载所有字段统计
  - 一键反选所有筛选条件
  - 实时显示筛选后的资产数量

- **搜索历史管理**
  - 自动保存搜索历史
  - 快速选择历史搜索语句
  - 支持删除单条历史记录

- **请求频率控制**
  - 智能请求队列管理
  - 冷却时间倒计时显示
  - 防止 API 请求过快被限制
  - 失败重试机制

- **FOFA 设置**
  - 在设置页面配置 FOFA API Email 和 API Key
  - 支持 FOFA 请求绕过全局代理（推荐开启）
  - 测试 FOFA 连接功能
  - 配置指引和帮助链接

### 高级功能模块

- **密码解锁机制**
  - 高级功能需要密码解锁才能使用
  - 解锁状态持久化保存
  - 支持关闭高级功能并重新锁定

- **高级功能设置**
  - 提供额外的安全测试功能
  - 关闭高级功能按钮

## 🎨 界面优化

### 批量验证页面

- **锁定状态提示**
  - 未配置 FOFA 时显示锁定卡片
  - 引导用户前往设置配置 API

- **用户信息展示**
  - 精美的用户头像和 VIP 徽章
  - 实时显示 F币和 F点余额
  - 连接状态指示器

- **筛选面板**
  - 树形结构展示统计数据
  - 复选框支持全选/部分选中状态
  - 加载状态和成功/失败图标
  - 空状态提示

### POC 验证页面

- **Monaco 编辑器集成**
  - 专业的代码编辑体验
  - HTML 语法高亮
  - 自动补全和格式化

### 设置页面

- **FOFA 设置分类**
  - 独立的 FOFA 设置分类
  - 数据库搜索图标（mdi-database-search）
  - 配置指引和帮助信息

- **高级功能分类**
  - 仅在解锁后显示
  - 钻石图标（mdi-check-decagram）
  - 功能开关和关闭按钮

## 🐛 Bug 修复

### SSL 证书验证问题

- **全面支持 SSL 证书忽略**
  - 为所有 HTTP 请求添加 SSL 证书忽略配置
  - 支持终端会话、favicon 获取、代理测试
  - 支持 IP 地址访问和代理场景
  - 修复 HTTPS 请求的证书验证问题

### HTTP 协议支持

- **修复 HTTP 协议问题**
  - 修复虚拟终端 CORS 问题
  - 支持 HTTP 和 HTTPS 混合使用
  - 优化协议检测逻辑

## 🔧 技术改进

### 后端架构

- **FOFA 处理器**
  - 新增 `fofa-handler.js` 模块
  - 完整的 FOFA API 封装
  - 支持代理绕过配置
  - 统一的错误处理机制

- **存储管理**
  - 扩展设置项支持 FOFA 配置
  - 高级功能解锁状态持久化
  - 搜索历史管理

### 前端架构

- **Monaco Editor 集成**
  - 使用 `@monaco-editor/loader` 动态加载
  - 支持 HTML 语言模式
  - 自适应容器大小

- **状态管理**
  - 使用 Vue 3 Provide/Inject 共享全局状态
  - 漏洞检测状态跨组件共享
  - 当前 URL 状态同步

## 📦 依赖更新

- 新增 `@monaco-editor/loader` - Monaco Editor 加载器
- 新增 `monaco-editor` - 代码编辑器核心库

## 📝 使用说明

### 配置 FOFA

1. 前往 [FOFA 个人中心](https://fofa.info/userInfo) 获取 API 凭证
2. 在"软件设置 → FOFA 设置"中配置 Email 和 API Key
3. 建议开启"FOFA 请求绕过代理"选项
4. 点击"测试 FOFA 连接"验证配置

### 使用批量验证

1. 确保已配置 FOFA API
2. 输入 FOFA 搜索语句（如：`app="Apache-Tomcat"`）
3. 点击"搜索"按钮
4. 在左侧筛选面板加载统计数据
5. 勾选需要的筛选条件
6. 查看右侧的资产列表和检测结果

### 解锁高级功能

1. 在设置页面找到隐藏的解锁入口
2. 输入正确的密码解锁
3. 解锁后会显示"高级功能"分类
4. 在高级功能中启用额外的安全测试功能

## ⚠️ 安全警告

- **高级功能仅供授权测试使用**
- 请勿在未经授权的系统上使用
- 使用本工具造成的任何后果由使用者自行承担

## 🎯 已知问题

- 批量验证的资产列表和检测功能尚未完成（下个版本实现）
- FOFA 搜索结果暂不支持导出

## 🔮 下个版本计划

- 完成批量验证的资产列表展示
- 实现批量 POC 检测功能
- 支持并发检测和进度跟踪
- 添加检测结果导出功能
